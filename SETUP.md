# Инструкция по установке HR-KTZH

## Шаг 1: Клонирование репозитория

Если проект уже загружен, перейдите в папку проекта:
\`\`\`bash
cd HR-KTZH
\`\`\`

## Шаг 2: Установка зависимостей

Установите все необходимые пакеты:
\`\`\`bash
npm install
\`\`\`

## Шаг 3: Настройка базы данных (Neon)

### 3.1. Создайте аккаунт на Neon.tech

1. Перейдите на [https://neon.tech](https://neon.tech)
2. Зарегистрируйтесь или войдите
3. Создайте новый проект
4. Выберите регион (рекомендуется ближайший к вам)
5. Скопируйте строку подключения (Connection String)

### 3.2. Настройте переменные окружения

Создайте файл `.env.local` в корне проекта:
\`\`\`bash
# В Windows
copy .env.example .env.local

# В Mac/Linux
cp .env.example .env.local
\`\`\`

Откройте `.env.local` и заполните:

\`\`\`env
# Вставьте вашу строку подключения из Neon
DATABASE_URL=postgresql://username:password@host.neon.tech/neondb?sslmode=require

# Сгенерируйте секретный ключ (см. ниже)
NEXTAUTH_SECRET=здесь_будет_сгенерированный_ключ

# URL вашего приложения
NEXTAUTH_URL=http://localhost:3000
\`\`\`

### 3.3. Сгенерируйте NEXTAUTH_SECRET

#### Вариант 1: Онлайн генератор
Используйте [https://generate-secret.vercel.app/32](https://generate-secret.vercel.app/32)

#### Вариант 2: Командная строка (если установлен OpenSSL)
\`\`\`bash
openssl rand -base64 32
\`\`\`

#### Вариант 3: Node.js
\`\`\`bash
node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
\`\`\`

Скопируйте полученный ключ в `.env.local`

## Шаг 4: Создание таблиц в базе данных

Создайте структуру базы данных:
\`\`\`bash
npm run db:push
\`\`\`

Эта команда создаст все необходимые таблицы в вашей базе данных Neon.

## Шаг 5: Заполнение начальными данными

Создайте первых пользователей:
\`\`\`bash
npm run db:seed
\`\`\`

Это создаст:
- **1 Супер Админа**: табельный `0000001`, пароль `SuperAdmin123!`
- **5 HR Супер Админов**: табельные `0000002-0000006`, пароль `HRSuper123!`

## Шаг 6: Запуск приложения

### Режим разработки
\`\`\`bash
npm run dev
\`\`\`

Приложение будет доступно по адресу [http://localhost:3000](http://localhost:3000)

### Production сборка
\`\`\`bash
npm run build
npm run start
\`\`\`

## Шаг 7: Первый вход в систему

1. Откройте браузер и перейдите на [http://localhost:3000](http://localhost:3000)
2. Вы будете перенаправлены на страницу входа
3. Войдите как Супер Админ:
   - **Табельный номер**: `0000001`
   - **Пароль**: `SuperAdmin123!`

## Возможные проблемы и решения

### Проблема: "Module not found" после npm install

**Решение:**
\`\`\`bash
# Удалите node_modules и package-lock.json
rm -rf node_modules package-lock.json

# Переустановите зависимости
npm install
\`\`\`

### Проблема: Ошибка подключения к базе данных

**Решение:**
1. Проверьте правильность строки подключения в `.env.local`
2. Убедитесь, что в Neon проект активен
3. Проверьте, что в строке подключения есть `?sslmode=require`

### Проблема: NextAuth ошибка при входе

**Решение:**
1. Убедитесь, что `NEXTAUTH_SECRET` заполнен в `.env.local`
2. Перезапустите сервер разработки после изменения `.env.local`

### Проблема: Tailwind стили не работают

**Решение:**
\`\`\`bash
# Установите PostCSS и Autoprefixer
npm install -D tailwindcss postcss autoprefixer
\`\`\`

## Дополнительно

### Просмотр данных в базе

Используйте Neon Console или установите Drizzle Studio:
\`\`\`bash
npm install -D drizzle-kit
npx drizzle-kit studio
\`\`\`

### Сброс базы данных

Если нужно очистить базу и начать заново:
\`\`\`bash
# Удалите все таблицы через Neon Console
# Затем создайте их снова:
npm run db:push
npm run db:seed
\`\`\`

## Следующие шаги

После успешной установки вы можете:
1. Создавать новых пользователей
2. Назначать роли
3. Создавать курсы (только HR Супер Админы)
4. Импортировать пользователей из Excel

## Поддержка

Если возникли проблемы:
1. Проверьте логи в консоли
2. Убедитесь, что все переменные окружения настроены
3. Проверьте, что база данных доступна
4. Создайте issue в репозитории проекта
